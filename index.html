<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOS Simples Saúde - Registrar Sala</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@7.2.96/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./css/root.css">
    <link rel="stylesheet" href="./css/index.css">
</head>

<body class="auth-bg">
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6">
                <div class="auth-card">
                    <!-- Cabeçalho com informações do profissional -->
                    <div class="professional-header d-flex align-items-center mb-4 p-3 rounded-3"
                        style="background: rgba(94, 96, 213, 0.1);">
                        <div class="professional-avatar me-3">
                            <i class="mdi mdi-account-circle" style="font-size: 3rem; color: var(--primary);"></i>
                        </div>
                        <div>
                            <h5 class="mb-0 fw-bold" id="professional-name-display">Dr. João Silva</h5>
                            <small class="text-muted" id="professional-specialty-display">Cardiologista</small>
                        </div>
                    </div>

                    <div class="auth-header">
                        <div class="auth-icon">
                            <i class="mdi mdi-door-closed-lock"></i>
                        </div>
                        <h2 class="auth-title">Configuração Profissional</h2>
                        <p class="auth-subtitle">Registre sua sala para iniciar o atendimento</p>
                    </div>

                    <form id="register-room-form" class="auth-form">
                        <div class="form-group">
                            <label for="room-number" class="form-label">Número da Sala</label>
                            <div class="input-group">
                                <span class="input-group-icon">
                                    <i class="mdi mdi-door"></i>
                                </span>
                                <input type="text" class="form-control" id="room-number" placeholder="Ex: 205" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="panel-select" class="form-label">Painel</label>
                            <div class="input-group">
                                <span class="input-group-icon">
                                    <i class="mdi mdi-stethoscope"></i>
                                </span>
                                <select class="form-select" id="panel-select" required>
                                    <option value="" selected disabled>Selecione o painel...</option>
                                    <option value="pediatria">Pediatria</option>
                                    <option value="clinica">Clínica Geral</option>
                                    <option value="psicologia">Psicologia</option>
                                    <option value="cardiologia">Cardiologia</option>
                                    <option value="odontologia">Odontologia</option>
                                    <option value="fisioterapia">Fisioterapia</option>
                                </select>
                            </div>
                        </div>

                        <input type="hidden" id="professional-name" value="Dr. João Silva">
                        <input type="hidden" id="professional-specialty" value="Cardiologista">

                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary btn-auth">
                                <i class="mdi mdi-login me-2"></i> Iniciar Atendimento
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        $(document).ready(function () {
            // Simulando dados do profissional (no seu caso, virá do PHP)
            const professionalData = {
                name: "Dr. João Silva",
                specialty: "Cardiologista"
            };

            // Preenche os campos com os dados do profissional
            $('#professional-name-display').text(professionalData.name);
            $('#professional-specialty-display').text(professionalData.specialty);
            $('#professional-name').val(professionalData.name);
            $('#professional-specialty').val(professionalData.specialty);

            // Se o profissional tiver uma especialidade, seleciona automaticamente o painel correspondente
            if (professionalData.specialty.toLowerCase().includes('cardio')) {
                $('#panel-select').val('cardiologia');
            } else if (professionalData.specialty.toLowerCase().includes('pediatra')) {
                $('#panel-select').val('pediatria');
            } // Adicione outros mapeamentos conforme necessário

            $('#register-room-form').submit(function (e) {
                e.preventDefault();

                const roomData = {
                    roomNumber: $('#room-number').val(),
                    panel: $('#panel-select').val(),
                    professional: $('#professional-name').val(),
                    specialty: $('#professional-specialty').val(),
                    panelText: $('#panel-select option:selected').text()
                };

                // Mostra SweetAlert com barra de progresso
                Swal.fire({
                    title: 'Configurando sua sala...',
                    html: `
                    <div class="text-left mb-3">Preparando ambiente para:<br>
                    <b>Sala ${roomData.roomNumber}</b> - ${roomData.panelText}<br>
                    Profissional: <b>${roomData.professional}</b> (${roomData.specialty})</div>
                    <div class="progress" style="height: 20px;">
                        <div id="progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" 
                             role="progressbar" style="width: 0%"></div>
                    </div>
                `,
                    showConfirmButton: false,
                    allowOutsideClick: false,
                    didOpen: () => {
                        const progressBar = document.getElementById('progress-bar');
                        let progress = 0;
                        const interval = setInterval(() => {
                            progress += Math.random() * 15;
                            if (progress > 100) progress = 100;
                            progressBar.style.width = `${progress}%`;

                            if (progress === 100) {
                                clearInterval(interval);
                                Swal.close();
                                localStorage.setItem('roomData', JSON.stringify(roomData));
                                window.location.href = 'atendimento.html';
                            }
                        }, 300);
                    }
                });
            });
        });
    </script>
</body>

</html>