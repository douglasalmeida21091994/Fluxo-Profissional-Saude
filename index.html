<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOS Simples Saúde - Registrar Sala</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@7.2.96/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <link rel="stylesheet" href="./css/root.css">
    <link rel="stylesheet" href="./css/index.css">
</head>

<body>
    <!-- Efeito de partículas -->
    <div id="particles-js"></div>

    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6">
                <div class="auth-card" id="auth-card">
                    <!-- Cabeçalho com informações do profissional -->
                    <div class="professional-header">
                        <div class="professional-avatar">
                            <i class="mdi mdi-account-circle"></i>
                        </div>
                        <div>
                            <h5 class="mb-0 fw-bold" id="professional-name-display">Dr. João Silva</h5>
                            <small class="text-muted" id="professional-specialty-display">Cardiologista</small>
                        </div>
                    </div>

                    <div class="auth-header">
                        <div class="auth-icon">
                            <i class="mdi mdi-door-closed-lock"></i>
                        </div>
                        <h2 class="auth-title">Configuração Profissional</h2>
                        <p class="auth-subtitle">Registre sua sala para iniciar o atendimento</p>
                    </div>

                    <form id="register-room-form" class="auth-form">
                        <div class="form-group">
                            <label for="room-number" class="form-label">Número da Sala</label>
                            <div class="input-group">
                                <span class="input-group-icon">
                                    <i class="mdi mdi-door"></i>
                                </span>
                                <input type="text" class="form-control" id="room-number" placeholder="Ex: 205" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="panel-select" class="form-label">Painel</label>
                            <div class="input-group">
                                <span class="input-group-icon">
                                    <i class="mdi mdi-stethoscope"></i>
                                </span>
                                <select class="form-select" id="panel-select" required>
                                    <option value="" selected disabled>Selecione o painel...</option>
                                    <option value="pediatria">Pediatria</option>
                                    <option value="clinica">Clínica Geral</option>
                                    <option value="psicologia">Psicologia</option>
                                    <option value="cardiologia">Cardiologia</option>
                                    <option value="odontologia">Odontologia</option>
                                    <option value="fisioterapia">Fisioterapia</option>
                                </select>
                            </div>
                        </div>

                        <input type="hidden" id="professional-name" value="Dr. João Silva">
                        <input type="hidden" id="professional-specialty" value="Cardiologista">

                        <div class="form-actions">
                            <button type="submit" class="btn btn-auth btn-primary">
                                <i class="mdi mdi-login me-2"></i> Iniciar Atendimento
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        // Inicializa o particles.js
        document.addEventListener('DOMContentLoaded', function () {
            particlesJS('particles-js', {
                "particles": {
                    "number": {
                        "value": 80,
                        "density": {
                            "enable": true,
                            "value_area": 800
                        }
                    },
                    "color": {
                        "value": "#ffffff"
                    },
                    "shape": {
                        "type": "circle",
                        "stroke": {
                            "width": 0,
                            "color": "#000000"
                        }
                    },
                    "opacity": {
                        "value": 0.5,
                        "random": true,
                        "anim": {
                            "enable": true,
                            "speed": 1,
                            "opacity_min": 0.1,
                            "sync": false
                        }
                    },
                    "size": {
                        "value": 3,
                        "random": true
                    },
                    "line_linked": {
                        "enable": true,
                        "distance": 150,
                        "color": "#ffffff",
                        "opacity": 0.4,
                        "width": 1
                    },
                    "move": {
                        "enable": true,
                        "speed": 2,
                        "direction": "none",
                        "random": true,
                        "straight": false,
                        "out_mode": "out",
                        "bounce": false
                    }
                },
                "interactivity": {
                    "detect_on": "canvas",
                    "events": {
                        "onhover": {
                            "enable": true,
                            "mode": "repulse"
                        },
                        "onclick": {
                            "enable": true,
                            "mode": "push"
                        }
                    }
                }
            });
        });

        $(document).ready(function () {
            // Ativa a borda quando os campos ganham foco
            // $('#room-number, #panel-select').focus(function () {
            //     $('#auth-card').addClass('active-border');
            // });

            // Desativa a borda quando os campos perdem foco
            // $('#room-number, #panel-select').blur(function () {
            //     $('#auth-card').removeClass('active-border');
            // });

            // Simulando dados do profissional
            const professionalData = {
                name: "Dr. João Silva",
                specialty: "Cardiologista"
            };

            // Preenche os campos com os dados do profissional
            $('#professional-name-display').text(professionalData.name);
            $('#professional-specialty-display').text(professionalData.specialty);
            $('#professional-name').val(professionalData.name);
            $('#professional-specialty').val(professionalData.specialty);

            // Seleciona automaticamente o painel correspondente à especialidade
            if (professionalData.specialty.toLowerCase().includes('cardio')) {
                $('#panel-select').val('cardiologia');
            }

            $('#register-room-form').submit(function (e) {
                e.preventDefault();

                const roomData = {
                    roomNumber: $('#room-number').val(),
                    panel: $('#panel-select').val(),
                    professional: $('#professional-name').val(),
                    specialty: $('#professional-specialty').val(),
                    panelText: $('#panel-select option:selected').text()
                };

                // Mostra SweetAlert com barra de progresso
                Swal.fire({
                    title: 'Configurando sua sala...',
                    html: `
                    <div class="text-left mb-3">Preparando ambiente para:<br>
                    <b>Sala ${roomData.roomNumber}</b> - ${roomData.panelText}<br>
                    Profissional: <b>${roomData.professional}</b> (${roomData.specialty})</div>
                    <div class="progress" style="height: 20px;">
                        <div id="progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" 
                             role="progressbar" style="width: 0%"></div>
                    </div>
                `,
                    showConfirmButton: false,
                    allowOutsideClick: false,
                    didOpen: () => {
                        const progressBar = document.getElementById('progress-bar');
                        let progress = 0;
                        const interval = setInterval(() => {
                            progress += Math.random() * 15;
                            if (progress > 100) progress = 100;
                            progressBar.style.width = `${progress}%`;

                            if (progress === 100) {
                                clearInterval(interval);
                                Swal.close();
                                localStorage.setItem('roomData', JSON.stringify(roomData));
                                window.location.href = 'atendimento.html';
                            }
                        }, 300);
                    }
                });
            });
        });
    </script>
</body>

</html>